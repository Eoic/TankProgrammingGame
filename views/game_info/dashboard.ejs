<!doctype html>
<html lang="en">
  <head>
    <% include ../partials/styles %>
    <title> Dashboard </title>
  </head>
  <body class="bg-light-blue">
    <% include ../partials/navbar %> 
    <% include ../partials/bootstrapjs %> 

    <div id="sidebarID" class="sidebar shader bg-medium-blue">
          <h5 class="text-light pt-4 pl-3">
            <img src="../../img/profile.png" class="img-rounded pr-2" style="max-width: 20%; max-height: 20%;"> 
            <%= name %> 
          </h5>
        <hr/>
        <button type="button" id="summary" class="btn btn-lg btn-block rounded-0 mb-0 text-left text-light sidebar-button"> 
          <i class="fa fa-address-card"></i> Overview 
        </button>
        <button type="button" id="robot-list" class="btn btn-lg btn-block rounded-0 mt-0 text-left text-light sidebar-button"> 
          <i class="fa fa-code"></i> Robots 
        </button>
        <button type="button" id="statistics" class="btn btn-lg btn-block rounded-0 mt-0 text-left text-light sidebar-button"> 
          <i class="fa fa-bar-chart"></i> Statistics 
        </button>
        <button type="button" id="achievements" class="btn btn-lg btn-block rounded-0 mt-0 text-left text-light sidebar-button"> 
          <i class="fa fa-unlock"></i> Achievements 
        </button>
        <button type="button" id="user-settings" class="btn btn-lg btn-block rounded-0 mt-0 text-left text-light sidebar-button"> 
          <i class="fa fa-cogs"></i> Settings 
        </button>
    </div>

    <!-- ONLY THIS WRAPPER WILL BE PUSHED BY SIDEBAR -->
    <div id="main">
      <span class="navbar-toggler bars" style="font-size:30px; cursor:pointer;" onclick="toggleSidebar()">
        <i class="fa fa-bars"></i>
      </span>

      <!-- All content will be rendered in this div -->
      <div id="content">
          <% include ../user/overview %>
      </div>
    </div>

    <script>
      // Setting previous state.
      switch(localStorage.getItem("sidebarState")){
        case 'open':
            openSidebar();
            break;
        case 'closed' || null:
            closeSidebar();
            break;
      }

      // Toggling current state.
      function toggleSidebar(){
        if(document.getElementById("sidebarID").style.width == "0px")
          openSidebar();
        else
          closeSidebar();
      }

      function openSidebar(){
        document.getElementById("sidebarID").style.width = "250px";
        document.getElementById("main").style.marginLeft = "250px";
        localStorage.setItem("sidebarState", "open");
      }

      function closeSidebar(){
        document.getElementById("sidebarID").style.width = "0";
        document.getElementById("main").style.marginLeft = "0";
        localStorage.setItem("sidebarState", "closed");
      }

      // Setting default page.
      var $body = $('#content');
      $('#summary').addClass('active').siblings().removeClass('active');

      // On click events for other pages.
      $('#summary').click(function(){ selectButton('overview', this)});
      $('#robot-list').click(function(){ selectButton('robots', this)});
      $('#user-settings').click(function(){ selectButton('settings', this)});
      $('#achievements').click(function(){ selectButton('achievements', this) });
      $('#statistics').click(function(){ selectButton('statistics', this) });

      // Called inside click() event handler.
      function selectButton(pageToLoad, id){
        $(id).addClass('active').siblings().removeClass('active');
        $body.load('/' + pageToLoad);
      }

    </script>
   </body>
</html>